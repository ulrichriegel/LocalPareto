stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1.5) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
alpha16 <- function(x) alpha(x, 16)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1.5) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
alpha8 <- function(x) alpha(x, 8)
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1.5) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1.5) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
library(Pareto)
library(LocalPareto)
rm(list = ls())
library(LocalPareto)
library(Pareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x, tau) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
library(ggplot2)
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(fun = function(x) alpha(x, 4), size = 1.5, color = "black") +
stat_function(fun = function(x) alpha(x, 2), size = 1.5, color = "black") +
stat_function(fun = function(x) alpha(x, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) alpha(x, .5), size = 1.5, color = "black") +
stat_function(fun = function(x) alpha(x, .25), size = 1.5, color = "black") +
stat_function(fun = function(x) alpha(x, .1), size = 1.5, color = "black")
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(fun = function(x) alpha(x, 4), linewidth = 1.5, color = "black") +
stat_function(fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, .1), linewidth = 1, color = "black")
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(fun = function(x) alpha(x, .1), linewidth = 1, color = "black")
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black")
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(0, 999)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(0, 999)), fun = function(x) 0, linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 950)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 700)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 500)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
library(ggplot2)
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 200)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 200)), fun = function(x) 0, linewidth = 1, color = "green") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(aes(x = x)) +
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(0, 200)), aes(x = x), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
alpha.05 <- function(x) alpha(x, .05)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.05), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
beta <- function(x) 2 * alpha(x)
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
(2.808313e-05)^2
(2.808313e-05)^.5
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(1000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(1000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
0.002750467^.5
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), size = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
theta <- 1000
tau <- 3
alpha <- function(x) tau * (x / theta) ^ tau
pWeibull <- function(x, theta, tau) 1 - exp(-(x / theta) ^ tau)
pWeibull((1:5) * 500, theta, tau)
pLocalPareto((1:5) * 500, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), size = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x, tau) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
library(ggplot2)
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), size = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), size = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), size = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), size = 1.5, color = "gray")
t <- 1000
mu <- 0
sigma <- 2
LogNorm_local_alpha <- function(x) {
ifelse(x >= t,
x * dlnorm(x, meanlog = mu, sdlog = sigma) /
(1 - plnorm(x, meanlog = mu, sdlog = sigma)),
0)
}
alpha_0 <- LogNorm_local_alpha(t)
delta <- (LogNorm_local_alpha(t * exp(1)) - alpha_0) * log(2)
alpha <- function(x) ifelse(x >= t, alpha_0 + delta * log(x/t) / log(2), 0)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) LogNorm_local_alpha(x), size = 5, color = "gray") +
stat_function(fun = function(x) alpha(x), size = 1.5)
1 - (1 - plnorm((1:6) * 1000, mu, sigma)) / (1 - plnorm(t, mu, sigma))
pLocalPareto((1:6) * 1000, alpha)
pLALocPareto((1:6) * 1000, t, alpha_0, delta = delta)
pLocalPareto((1:6) * 1000, alpha)
pLALocPareto((1:6) * 1000, t, alpha_0, delta = delta)
t <- 1000
pLocalPareto((1:6) * 1000, alpha)
pLocalPareto((1:6) * 1000, alpha, t=t)
pLocalPareto((1:6) * 1000, alpha)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
0.00278024^0.5
alpha <- function(x) ifelse(x>=t, x/20000*(1 / 2  + 1 / 2 * sin(4 * (x - t) / t)), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
alpha <- function(x) ifelse(x>=t, (.6+x/50000)*(1 / 2  + 1 / 2 * sin(4 * (x - t) / t)), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
library(LocalPareto)
alpha <- function(x) ifelse(x>=1000, 2 - 1000 / x, 0)
LocalPareto_2_PiecewisePareto(alpha)
t[-1] / t[-length(t)]
t <- LocalPareto_2_PiecewisePareto(alpha)$t
t[-1] / t[-length(t)]
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Mean(9000, 1000, alpha)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
library(ggplot2)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_2_PiecewisePareto(alpha)
LocalPareto_2_PiecewisePareto(alpha)[5000]
LocalPareto_2_PiecewisePareto(alpha)$t[5000]
LocalPareto_2_PiecewisePareto(alpha)$SF[5000]
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
