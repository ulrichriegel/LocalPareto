}
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
t <- 1000
mu <- 0
sigma <- 2
LogNorm_local_alpha <- function(x) {
ifelse(x >= t,
x * dlnorm(x, meanlog = mu, sdlog = sigma) /
(1 - plnorm(x, meanlog = mu, sdlog = sigma)),
0)
}
alpha_0 <- LogNorm_local_alpha(t)
delta <- (LogNorm_local_alpha(t * exp(1)) - alpha_0) * log(2)
alpha <- function(x) ifelse(x >= t, alpha_0 + delta * log(x/t) / log(2), 0)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) LogNorm_local_alpha(x), linewidth = 5, color = "gray") +
stat_function(fun = function(x) alpha(x), linewidth = 1.5)
1 - (1 - plnorm((1:6) * 1000, mu, sigma)) / (1 - plnorm(t, mu, sigma))
pLocalPareto((1:6) * 1000, alpha)
pLALocPareto((1:6) * 1000, t, alpha_0, delta = delta)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t) / t), 0)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(3 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
ppmod$alpha
library(LocalPareto)
nlosses <- 1000
nsim <- 100
t <- 1000
alpha_0 <- 1
delta <- 0.5
gamma <- delta / alpha_0 / log(2)
gamma_known <- F
delta_known <- F
if (gamma_known & delta_known) {
stop("Only gamma or delta can be known!")
}
MLE_alpha_0 <- numeric(nsim)
MLE_gamma <- numeric(nsim)
MLE_delta <- numeric(nsim)
asympCovMatrix <- matrix(0, 2, 2)
asympCovMatrix2 <- matrix(0, 2, 2)
for (i in 1:nsim) {
losses <- rLALocPareto(nlosses, t, alpha_0, gamma = gamma)
if (!gamma_known & !delta_known) {
MLE <- LALocPareto_ML_Estimator_Alpha(losses, t)
} else if (gamma_known) {
MLE <- LALocPareto_ML_Estimator_Alpha(losses, t, gamma = gamma)
} else if (delta_known) {
MLE <- LALocPareto_ML_Estimator_Alpha(losses, t, delta = delta)
}
MLE_alpha_0[i] <- MLE$alpha_0_hat
MLE_gamma[i] <- MLE$gamma_hat
MLE_delta[i] <- MLE$delta_hat
asympCovMatrix <- asympCovMatrix + MLE$ApproxCovMatrix / nsim
asympCovMatrix2 <- asympCovMatrix2 + MLE$ApproxCovMatrix2 / nsim
}
simCovMatrix <- matrix(NA, 2, 2)
simCovMatrix[1,1] <- var(MLE_alpha_0)
simCovMatrix[1,2] <- cov(MLE_alpha_0, MLE_gamma)
library(LocalPareto)
nlosses <- 1000
nsim <- 100
t <- 1000
alpha_0 <- 1
delta <- 0.5
gamma <- delta / alpha_0 / log(2)
gamma_known <- F
delta_known <- F
if (gamma_known & delta_known) {
stop("Only gamma or delta can be known!")
}
MLE_alpha_0 <- numeric(nsim)
MLE_gamma <- numeric(nsim)
MLE_delta <- numeric(nsim)
library(LocalPareto)
nlosses <- 1000
nsim <- 100
t <- 1000
alpha_0 <- 1
delta <- 0.5
gamma <- delta / alpha_0 / log(2)
gamma_known <- F
delta_known <- F
if (gamma_known & delta_known) {
stop("Only gamma or delta can be known!")
}
MLE_alpha_0 <- numeric(nsim)
MLE_gamma <- numeric(nsim)
MLE_delta <- numeric(nsim)
asympCovMatrix <- matrix(0, 2, 2)
asympCovMatrix2 <- matrix(0, 2, 2)
for (i in 1:nsim) {
losses <- rLALocPareto(nlosses, t, alpha_0, gamma = gamma)
if (!gamma_known & !delta_known) {
MLE <- LALocPareto_ML_Estimator(losses, t)
} else if (gamma_known) {
MLE <- LALocPareto_ML_Estimator(losses, t, gamma = gamma)
} else if (delta_known) {
MLE <- LALocPareto_ML_Estimator(losses, t, delta = delta)
}
MLE_alpha_0[i] <- MLE$alpha_0_hat
MLE_gamma[i] <- MLE$gamma_hat
MLE_delta[i] <- MLE$delta_hat
asympCovMatrix <- asympCovMatrix + MLE$ApproxCovMatrix / nsim
asympCovMatrix2 <- asympCovMatrix2 + MLE$ApproxCovMatrix2 / nsim
}
simCovMatrix <- matrix(NA, 2, 2)
simCovMatrix[1,1] <- var(MLE_alpha_0)
simCovMatrix[1,2] <- cov(MLE_alpha_0, MLE_gamma)
simCovMatrix[2,1] <- simCovMatrix[1,2]
simCovMatrix[2,2] <- var(MLE_gamma)
rownames(simCovMatrix) <- c("alpha_0", "gamma")
colnames(simCovMatrix) <- rownames(simCovMatrix)
simCovMatrix2 <- matrix(NA, 2, 2)
simCovMatrix2[1,1] <- var(MLE_alpha_0)
simCovMatrix2[1,2] <- cov(MLE_alpha_0, MLE_delta)
simCovMatrix2[2,1] <- simCovMatrix2[1,2]
simCovMatrix2[2,2] <- var(MLE_delta)
rownames(simCovMatrix2) <- c("alpha_0", "delta")
colnames(simCovMatrix2) <- rownames(simCovMatrix2)
df_comparison <- data.frame(Type = c("Parameter", "MLE"),
alpha_0 = c(alpha_0, mean(MLE_alpha_0)),
gamma = c(gamma, mean(MLE_gamma)),
delta = c(delta, mean(MLE_delta)))
simCovMatrix
asympCovMatrix
simCovMatrix2
asympCovMatrix2
df_comparison
source("~/R/LocalPareto/AccuracyAssymptoticCovariance.R", echo = TRUE)
valid.parameters.PiecewisePareto <- function(Parameters_PP, comment = FALSE) {
t <- NULL
alpha <- NULL
SF <- NULL
try(t <- Parameters_PP$t, silent = T)
try(alpha <- Parameters_PP$alpha, silent = T)
try(SF <- Parameters_PP$SF, silent = T)
if (!is.positive.finite.vector(t) || !is.nonnegative.finite.vector(alpha) || !is.positive.finite.vector(SF)) {
if (!comment) {
return(FALSE)
} else {
return("t and SF must be a positive vectors, alpha must be a non-negative vector.")
}
}
k <- length(t)
if (length(alpha) != k || length(SF != k)) {
if (!comment) {
return(FALSE)
} else {
return("t, alpha, and SF must have the same length.")
}
}
if (k > 1 && min(diff(t))<=0) {
if (!comment) {
return(FALSE)
} else {
return("t must be increasing.")
}
}
if (k > 1 && max(diff(SF))>0) {
if (!comment) {
return(FALSE)
} else {
return("SF must be decreasing.")
}
}
if (alpha[k] <= 0) {
if (!comment) {
return(FALSE)
} else {
return("Last alpha must be positive.")
}
}
if (!comment) {
return(TRUE)
} else {
return("OK")
}
}
rm(list = ls())
library(Pareto)
library(LocalPareto)
alpha_0 <- 1.5
t <- 1000
gamma <- 0.5
alpha <- function(x) alpha_0 + alpha_0 * gamma * log(x/t)
alpha_t <- function(x) {
if (x>t) {
alpha_0 + alpha_0 * gamma * log(x/t)
} else {
0
}
}
alpha_t2 <- function(x) {
return(ifelse(x>t, alpha_0 + alpha_0 * gamma * log(x/t), 0))
}
PP_Parameters <- LocalPareto_2_PiecewisePareto(alpha, t)
valid.parameters.PiecewisePareto <- function(Parameters_PP, comment = FALSE) {
t <- NULL
alpha <- NULL
SF <- NULL
try(t <- Parameters_PP$t, silent = T)
try(alpha <- Parameters_PP$alpha, silent = T)
try(SF <- Parameters_PP$SF, silent = T)
if (!is.positive.finite.vector(t) || !is.nonnegative.finite.vector(alpha) || !is.positive.finite.vector(SF)) {
if (!comment) {
return(FALSE)
} else {
return("t and SF must be a positive vectors, alpha must be a non-negative vector.")
}
}
k <- length(t)
if (length(alpha) != k || length(SF != k)) {
if (!comment) {
return(FALSE)
} else {
return("t, alpha, and SF must have the same length.")
}
}
if (k > 1 && min(diff(t))<=0) {
if (!comment) {
return(FALSE)
} else {
return("t must be increasing.")
}
}
if (k > 1 && max(diff(SF))>0) {
if (!comment) {
return(FALSE)
} else {
return("SF must be decreasing.")
}
}
if (alpha[k] <= 0) {
if (!comment) {
return(FALSE)
} else {
return("Last alpha must be positive.")
}
}
if (!comment) {
return(TRUE)
} else {
return("OK")
}
}
valid.parameters.PiecewisePareto(PP_Parameters)
source("./ValidationFunctions.R")
source("ValidationFunctions.R")
source("./R/ValidationFunctions.R")
valid.parameters.PiecewisePareto(PP_Parameters)
PP_Parameters
valid.parameters.PiecewisePareto(PP_Parameters, T)
source("./R/ValidationFunctions.R")
valid.parameters.PiecewisePareto(PP_Parameters, T)
valid.parameters.PiecewisePareto(PP_Parameters)
PPP <- list(t=c(1,2,3), alpha = c(1,2,3))
valid.parameters.PiecewisePareto(PPP)
valid.parameters.PiecewisePareto(PPP, comment = T)
PPP <- list(t=c(1,2,3), alpha = c(1,2,3), SF = c(1,2,3))
valid.parameters.PiecewisePareto(PPP, comment = T)
PPP <- list(t=c(1,2,3), alpha = c(1,2,3), SF = c(1,.3,.1))
valid.parameters.PiecewisePareto(PPP, comment = T)
source("./R/ValidationFunctions.R")
PPP <- list(t=c(1,2,3), alpha = c(1,2,3), SF = c(1,.3,.1))
valid.parameters.PiecewisePareto(PPP, comment = T)
valid.parameters.PiecewisePareto(PPP, comment = F)
PPP <- list(t=c(1,2,3), alpha = c(1,2,3), SF = c(1.01,.3,.1))
valid.parameters.PiecewisePareto(PPP, comment = F)
valid.parameters.PiecewisePareto(PPP, comment = T)
valid.parameters.PiecewisePareto(NULL, comment = T)
rm(list = ls())
library(Pareto)
library(LocalPareto)
library(ggplot2)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
theta <- 1000
tau <- 3
alpha <- function(x) tau * (x / theta) ^ tau
pWeibull <- function(x, theta, tau) 1 - exp(-(x / theta) ^ tau)
pWeibull((1:5) * 500, theta, tau)
pLocalPareto((1:5) * 500, alpha)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x, tau) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
t <- 1000
mu <- 0
sigma <- 2
LogNorm_local_alpha <- function(x) {
ifelse(x >= t,
x * dlnorm(x, meanlog = mu, sdlog = sigma) /
(1 - plnorm(x, meanlog = mu, sdlog = sigma)),
0)
}
alpha_0 <- LogNorm_local_alpha(t)
delta <- (LogNorm_local_alpha(t * exp(1)) - alpha_0) * log(2)
alpha <- function(x) ifelse(x >= t, alpha_0 + delta * log(x/t) / log(2), 0)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) LogNorm_local_alpha(x), linewidth = 5, color = "gray") +
stat_function(fun = function(x) alpha(x), linewidth = 1.5)
1 - (1 - plnorm((1:6) * 1000, mu, sigma)) / (1 - plnorm(t, mu, sigma))
pLocalPareto((1:6) * 1000, alpha)
pLALocPareto((1:6) * 1000, t, alpha_0, delta = delta)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t) / t), 0)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(3 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
ppmod$alpha
devtools::check()
rm(list = ls())
library(Pareto)
library(LocalPareto)
library(ggplot2)
pModGenPareto <- function(x, tau) {
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
return(pLocalPareto(x, alpha))
}
t <- 1000
pModGenPareto <- function(x, tau) {
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
return(pLocalPareto(x, alpha))
}
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pModGenPareto(x, 16), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, 8), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, 4), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, 2), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, 1), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, .5), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, .25), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, .1), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, a.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
pModGenPareto <- function(x, alpha_ini, alpha_tail, tau) {
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
return(pLocalPareto(x, alpha))
}
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, 16), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, 8), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, 4), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, 2), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, 1), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, .5), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, .25), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, .1), linewidth = 1) +
stat_function(fun = function(x) pModGenPareto(x, alpha_ini, alpha_tail, a.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
rm(list = ls())
library(Pareto)
library(LocalPareto)
library(ggplot2)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x, tau) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "red") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
