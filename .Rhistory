alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), size = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_2_PiecewisePareto(alpha)
LocalPareto_2_PiecewisePareto(alpha)[5000]
LocalPareto_2_PiecewisePareto(alpha)$t[5000]
LocalPareto_2_PiecewisePareto(alpha)$SF[5000]
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
theta <- 1000
tau <- 3
alpha <- function(x) tau * (x / theta) ^ tau
pWeibull <- function(x, theta, tau) 1 - exp(-(x / theta) ^ tau)
pWeibull((1:5) * 500, theta, tau)
pLocalPareto((1:5) * 500, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), size = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
rm(list = ls())
library(Pareto)
library(LocalPareto)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
theta <- 1000
tau <- 3
alpha <- function(x) tau * (x / theta) ^ tau
pWeibull <- function(x, theta, tau) 1 - exp(-(x / theta) ^ tau)
pWeibull((1:5) * 500, theta, tau)
pLocalPareto((1:5) * 500, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), size = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), size = 1.5)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod
ppmod$t[4900:5000]
ppmod$SF[4900:5000]
ppmod$alpha[4900:5000]
rm(list = ls())
library(Pareto)
library(LocalPareto)
library(ggplot2)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x) {
ifelse(x < t, 0, alpha_tail * (x / t) / (alpha_tail / alpha_ini + x / t - 1))
}
pGenPareto(c(2000, 10000, 50000), t, alpha_ini, alpha_tail)
pLocalPareto(c(2000, 10000, 50000), alpha)
GenPareto_Layer_Mean(9000, 1000, t, alpha_ini, alpha_tail)
LocalPareto_Layer_Mean(9000, 1000, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) pGenPareto(x, t, alpha_ini, alpha_tail), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
theta <- 1000
tau <- 3
alpha <- function(x) tau * (x / theta) ^ tau
pWeibull <- function(x, theta, tau) 1 - exp(-(x / theta) ^ tau)
pWeibull((1:5) * 500, theta, tau)
pLocalPareto((1:5) * 500, alpha)
library(ggplot2)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
ggplot(data = data.frame(x = c(1, 3000)), aes(x = x)) +
stat_function(fun = function(x) pWeibull(x, theta, tau), linewidth = 5, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
t <- 1000
alpha_ini <- 1
alpha_tail <- 2
alpha <- function(x, tau) {
ifelse(x < t, 0, alpha_tail * ((tau * (x - t) + t) / t) / (alpha_tail / alpha_ini + (tau * (x - t) + t) / t - 1))
}
ggplot(data = data.frame(c(1, 50000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 4), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 2), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, 1), linewidth = 1, color = "gray") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .5), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .25), linewidth = 1, color = "black") +
stat_function(data = data.frame(x = c(1000, 50000)), fun = function(x) alpha(x, .1), linewidth = 1, color = "black") +
ylim(c(0,2))
alpha16 <- function(x) alpha(x, 16)
alpha8 <- function(x) alpha(x, 8)
alpha4 <- function(x) alpha(x, 4)
alpha2 <- function(x) alpha(x, 2)
alpha1 <- function(x) alpha(x, 1)
alpha.5 <- function(x) alpha(x, .5)
alpha.25 <- function(x) alpha(x, .25)
alpha.1 <- function(x) alpha(x, .1)
alpha.025 <- function(x) alpha(x, .025)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(fun = function(x) pLocalPareto(x, alpha16), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha8), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha4), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha2), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.5), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.25), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.1), linewidth = 1) +
stat_function(fun = function(x) pLocalPareto(x, alpha.025), linewidth = 1) +
stat_function(fun = function(x) pPareto(x, t, 1), linewidth = 1.5, color = "gray") +
stat_function(fun = function(x) pPareto(x, t, 2), linewidth = 1.5, color = "gray")
t <- 1000
mu <- 0
sigma <- 2
LogNorm_local_alpha <- function(x) {
ifelse(x >= t,
x * dlnorm(x, meanlog = mu, sdlog = sigma) /
(1 - plnorm(x, meanlog = mu, sdlog = sigma)),
0)
}
alpha_0 <- LogNorm_local_alpha(t)
delta <- (LogNorm_local_alpha(t * exp(1)) - alpha_0) * log(2)
alpha <- function(x) ifelse(x >= t, alpha_0 + delta * log(x/t) / log(2), 0)
ggplot(data = data.frame(x = c(1, 10000)), aes(x = x)) +
stat_function(fun = function(x) LogNorm_local_alpha(x), linewidth = 5, color = "gray") +
stat_function(fun = function(x) alpha(x), linewidth = 1.5)
1 - (1 - plnorm((1:6) * 1000, mu, sigma)) / (1 - plnorm(t, mu, sigma))
pLocalPareto((1:6) * 1000, alpha)
pLALocPareto((1:6) * 1000, t, alpha_0, delta = delta)
t <- 1000
alpha <- function(x) ifelse(x>=t, 1 / 2  + 1 / 2 * sin(4 * (x - t) / t), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
max(losses)
ppmod$t[5000]
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t) / t) + x / 50000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod
ppmod$t[5000]
ppmod$SF[5000]
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t) / t) + x / 20000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
2.521009e-05^.5
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
0.002869312^.5
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^1.5 / t^1.5) + x / 20000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.5 / t^0.5) + x / 20000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.8 / t^0.8) + x / 20000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + x / 20000, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (x / 100), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x)^.2, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.2 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.4 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 1 - (1000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (1000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^.1, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^.01, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^..5, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.3 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^.5, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000 / x)^0.1 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^.5, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 +  (1000 / x)^0.1 * sin(4 * (x - t)^0.7 / t^0.7) + 2 - (2000 / x)^.5, 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^.3 / t^.3), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^.3 / t^.3) +  log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^.1 / t^.1) +  log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^.8 / t^.8) +  log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * sin(4 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.2 * sin(4 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.4 * sin(4 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.4 * sin(4 * (x - t)^.8 / t^.8) +  .1 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.4 * sin(4 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(4 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
ppmod$t[2000]
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(8 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(3 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
ppmod$alpha
ppmod$alpha[1800]
ppmod$alpha[1700:1800]
alpha <- function(x) ifelse(x>=t, 1 / 2 + 1 / 2 * (1000/x)^.5 * sin(3 * (x - t)^.8 / t^.8) +  .2 * log(x / 1000), 0)
LocalPareto_Layer_Mean(9000, 1000, alpha)
LocalPareto_Layer_Var(9000, 1000, alpha)
ggplot(data = data.frame(x = c(1, 20000)), aes(x = x)) +
stat_function(data = data.frame(x = c(1000, 20000)),
fun = function(x) alpha(x), linewidth = 1.5, n=1000, color = "gray") +
stat_function(fun = function(x) pLocalPareto(x, alpha), linewidth = 1.5)
beta <- function(x) 2 * alpha(x)
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
losses <- rLocalPareto(10000, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)
2.434173e-05^.5
losses <- rLocalPareto(100, alpha)
LocalPareto_ML_Estimator_alpha_0(losses, t, beta)$alpha_0_hat
ppmod <- LocalPareto_2_PiecewisePareto(alpha)
ppmod$t
ppmod$alpha[1700:1800]
devtools::install_github("ulrichriegel/LocalPareto")
devtools::install_github("ulrichriegel/LocalPareto")
devtools::install_github("ulrichriegel/LocalPareto")
